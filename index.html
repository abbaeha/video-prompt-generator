<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cinematic Video Prompt Generator</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script> 
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script> 
    <script src="https://cdn.tailwindcss.com"></script> 
    <style>
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useCallback } = React;

        // --- Icon Components ---
        const FilmIcon = () => <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="2" width="20" height="20" rx="2" ry="2"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/></svg>;
        const UsersIcon = () => <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>;
        const MapPinIcon = () => <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>;
        const CameraIcon = () => <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>;
        const MusicIcon = () => <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>;
        const SparklesIcon = () => <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 3L9.5 8.5 4 11l5.5 2.5L12 19l2.5-5.5L20 11l-5.5-2.5z"/><path d="M5 3L3 8l5 2L3 12l2 5"/><path d="M19 3l2 5-5 2 5 2-2 5"/></svg>;
        const SlidersIcon = () => <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></svg>;
        const PlusCircleIcon = () => <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>;
        const CopyIcon = () => <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>;
        const ClipboardListIcon = () => <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="8" height="4" x="8" y="2" rx="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M12 11h4"/><path d="M12 16h4"/><path d="M8 11h.01"/><path d="M8 16h.01"/></svg>;
        
        // --- UI Components ---
        const MessageBox = ({ message, type, onClose }) => {
            if (!message) return null;
            const typeStyles = { 
                error: 'bg-red-100 border-red-500 text-red-700', 
                success: 'bg-green-100 border-green-500 text-green-700', 
                info: 'bg-blue-100 border-blue-500 text-blue-700' 
            };
            return ( 
                <div className={`fixed bottom-4 right-4 p-4 rounded-lg shadow-2xl ${typeStyles[type] || typeStyles['info']} border-l-4 z-50 animate-fade-in`}>
                    <div className="flex justify-between items-center">
                        <span className="font-medium">{message}</span>
                        <button onClick={onClose} className="ml-4 text-xl font-bold leading-none hover:text-black">&times;</button>
                    </div>
                </div>
            );
        };

        const Input = (props) => <input {...props} className="p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 w-full bg-slate-50"/>;
        const Select = (props) => <select {...props} className="p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 w-full bg-slate-50"/>;
        const Textarea = (props) => <textarea {...props} className="p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 w-full bg-slate-50"/>;
        const FormSection = ({ title, icon, children }) => (
            <div className="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                <h2 className="text-xl font-bold mb-4 flex items-center gap-3 text-slate-800">{icon}{title}</h2>
                <div className="space-y-4">{children}</div>
            </div>
        );

        function App() {
            // State Management
            const [definedCharacters, setDefinedCharacters] = useState([]);
            const [sceneSubjects, setSceneSubjects] = useState([]);
            const [mainDescription, setMainDescription] = useState('');
            const [setting, setSetting] = useState('');
            const [visualMood, setVisualMood] = useState('');
            const [cameraMovement, setCameraMovement] = useState('');
            const [cameraAngle, setCameraAngle] = useState('');
            const [lighting, setLighting] = useState('');
            const [cinematicStyle, setCinematicStyle] = useState('');
            const [backgroundMusic, setBackgroundMusic] = useState('');
            const [sfx, setSfx] = useState('');
            const [dialogueEntries, setDialogueEntries] = useState([]);
            const [aspectRatio, setAspectRatio] = useState('16:9');
            const [videoQuality, setVideoQuality] = useState('');
            const [loading, setLoading] = useState({ main: false, character: null, storyboard: null });
            const [message, setMessage] = useState('');
            const [messageType, setMessageType] = useState('info');
            const [englishPrompt, setEnglishPrompt] = useState('');
            const [indonesianPrompt, setIndonesianPrompt] = useState('');
            const [optimizedPrompt, setOptimizedPrompt] = useState('');
            const [storyboard, setStoryboard] = useState([]);

            // Options Data
            const cameraMovementOptions = [
                {value: 'Orbit / Rotate 360°', label: 'Orbit / Rotate 360°'},
                {value: 'Slow Push-in', label: 'Slow Push-in (Mendekat)'},
                {value: 'Pull-out Reveal', label: 'Pull-out Reveal (Menjauh)'}
            ];
            const cameraAngleOptions = [
                {value: 'Close-up shot', label: 'Close-up'},
                {value: 'Extreme close-up / Macro shot', label: 'Extreme Close-up / Macro'},
                {value: 'Low angle shot', label: 'Low angle (Dari Bawah)'}
            ];
            const lightingOptions = [
                {value: 'dramatic side lighting', label: 'Dramatic Side Lighting'},
                {value: 'moody shadows', label: 'Moody Shadows'},
                {value: 'golden hour style', label: 'Golden Hour'}
            ];
            const cinematicStyleOptions = [
                {value: 'hyperreal CGI', label: 'Hyperreal CGI'},
                {value: '35mm film look', label: '35mm Film Look'},
                {value: 'cinematic LUT', label: 'Cinematic LUT'}
            ];
            const visualMoodOptions = [
                {value: 'eerie', label: 'Eerie (Mencekam)'},
                {value: 'nostalgic', label: 'Nostalgic (Nostalgia)'},
                {value: 'tense', label: 'Tense (Tegang)'}
            ];
            const videoQualityOptions = ['4K', 'HD', 'Cinematic Quality'];
            const aspectRatioOptions = [
                { value: "16:9", label: "16:9 (Layar Lebar)" },
                { value: "9:16", label: "9:16 (Vertikal)" },
                { value: "1:1", label: "1:1 (Persegi)" }
            ];

            // Utility Functions
            const showMessage = useCallback((msg, type = 'info') => {
                setMessage(msg);
                setMessageType(type);
                setTimeout(() => setMessage(''), 5000);
            }, []);

            const copyToClipboard = (text, lang) => {
                if(!text) return;
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    showMessage(`${lang} prompt berhasil disalin!`, 'success');
                } catch (err) {
                    showMessage(`Gagal menyalin ${lang} prompt.`, 'error');
                }
                document.body.removeChild(textarea);
            };

            // Character Management
            const addDefinedCharacter = () => {
                setDefinedCharacters(chars => [
                    ...chars, 
                    { 
                        id: Date.now(), 
                        name: `Karakter #${chars.length + 1}`, 
                        appearance: '', 
                        clothing: '', 
                        ideaConcept: '' 
                    }
                ]);
            };

            const removeDefinedCharacter = (id) => {
                setDefinedCharacters(chars => chars.filter(char => char.id !== id));
            };

            const handleDefinedCharacterChange = (id, field, value) => {
                setDefinedCharacters(chars => 
                    chars.map(char => 
                        char.id === id ? { ...char, [field]: value } : char
                    )
                );
            };

            // Scene Subject Management
            const addSceneSubject = () => {
                setSceneSubjects(subs => [
                    ...subs, 
                    { 
                        id: Date.now(), 
                        characterId: null, 
                        action: '' 
                    }
                ]);
            };

            const removeSceneSubject = (id) => {
                setSceneSubjects(subs => subs.filter(sub => sub.id !== id));
            };

            const handleSceneSubjectChange = (id, field, value) => {
                setSceneSubjects(subs => 
                    subs.map(sub => 
                        sub.id === id ? { ...sub, [field]: value } : sub
                    )
                );
            };

            // Dialogue Management
            const addDialogueEntry = () => {
                setDialogueEntries(entries => [
                    ...entries, 
                    { 
                        id: Date.now(), 
                        characterId: null, 
                        text: '', 
                        tone: '' 
                    }
                ]);
            };

            const removeDialogueEntry = (id) => {
                setDialogueEntries(entries => 
                    entries.filter(entry => entry.id !== id)
                );
            };

            const handleDialogueEntryChange = (id, field, value) => {
                setDialogueEntries(entries => 
                    entries.map(entry => 
                        entry.id === id ? { ...entry, [field]: value } : entry
                    )
                );
            };

            // Prompt Generation Logic
            const buildBasePrompt = () => {
                const characterDefinitions = definedCharacters.map(c => 
                    `Karakter: ${c.name} - ${c.appearance}, berpakaian ${c.clothing}.`
                ).join(' ');

                const sceneActions = sceneSubjects
                    .map(s => {
                        const char = definedCharacters.find(c => c.id == s.characterId);
                        return char ? `${char.name}: ${s.action}` : '';
                    })
                    .filter(Boolean)
                    .join('; ');

                const dialogueLines = dialogueEntries
                    .map(entry => {
                        const char = definedCharacters.find(c => c.id == entry.characterId);
                        if (!char || !entry.text.trim()) return null;
                        return `${char.name} berkata, "${entry.text}" (dengan nada ${entry.tone || 'netral'})`;
                    })
                    .filter(Boolean)
                    .join('; ');

                return {
                    characterDefinitions,
                    sceneActions,
                    dialogueLines
                };
            };

            const generatePrompt = () => {
                if (!mainDescription) {
                    showMessage("Deskripsi Adegan Utama tidak boleh kosong.", "error");
                    return;
                }

                setLoading(prev => ({ ...prev, main: true }));
                setEnglishPrompt('');
                setIndonesianPrompt('');
                setOptimizedPrompt('');
                setStoryboard([]);

                try {
                    const base = buildBasePrompt();
                    
                    // Generate Indonesian Prompt
                    const idPrompt = `Deskripsi Adegan: ${mainDescription}
Lokasi: ${setting || 'Tidak ditentukan'}
Mood Visual: ${visualMood || 'Netral'}
Karakter:
${base.characterDefinitions}
Aksi: ${base.sceneActions}
Dialog: ${base.dialogueLines}
Teknik Sinematografi:
- Pergerakan Kamera: ${cameraMovement || 'Tidak ditentukan'}
- Sudut Kamera: ${cameraAngle || 'Tidak ditentukan'}
- Pencahayaan: ${lighting || 'Tidak ditentukan'}
- Gaya Visual: ${cinematicStyle || 'Tidak ditentukan'}
Spesifikasi Teknis:
- Rasio Aspek: ${aspectRatio || '16:9'}
- Kualitas Video: ${videoQuality || 'HD'}`;

                    // Generate English Prompt
                    const enPrompt = `Scene Description: ${mainDescription}
Setting: ${setting || 'Unspecified'}
Visual Mood: ${visualMood || 'Neutral'}
Characters:
${base.characterDefinitions.replace(/Karakter:/g, '-')}
Actions: ${base.sceneActions || 'No specific actions'}
Dialogue: ${base.dialogueLines || 'No dialogue'}
Cinematography:
- Camera Movement: ${cameraMovement || 'Unspecified'}
- Camera Angle: ${cameraAngle || 'Unspecified'}
- Lighting: ${lighting || 'Unspecified'}
- Visual Style: ${cinematicStyle || 'Unspecified'}
Technical Specs:
- Aspect Ratio: ${aspectRatio || '16:9'}
- Video Quality: ${videoQuality || 'HD'}`;

                    // Generate Optimized Prompt
                    const optPrompt = `Adegan sinematik yang memukau dalam format ${aspectRatio || '16:9'}, 
menggambarkan "${mainDescription}". Lokasi: ${setting || 'tempat misterius'} 
dengan suasana visual ${visualMood || 'netral'}. ${base.characterDefinitions} 
${base.sceneActions ? `Aksi dinamis: ${base.sceneActions}` : ''} 
${base.dialogueLines ? `Dialog penting: ${base.dialogueLines}` : ''} 
Pergerakan kamera menggunakan teknik ${cameraMovement || 'statis'}, 
sudut pengambilan gambar ${cameraAngle || 'standar'}, dengan pencahayaan 
${lighting || 'alami'} dan gaya visual ${cinematicStyle || 'klasik'}. 
Kualitas produksi ${videoQuality || 'HD'} dengan perhatian detail pada 
komposisi frame dan nuansa warna.`;

                    setIndonesianPrompt(idPrompt);
                    setEnglishPrompt(enPrompt);
                    setOptimizedPrompt(optPrompt);
                } catch (error) {
                    showMessage(error.message || 'Terjadi kesalahan.', 'error');
                } finally {
                    setLoading(prev => ({ ...prev, main: false }));
                }
            };

            // Mock Character Generation
            const handleGenerateCharacter = (charId) => {
                const character = definedCharacters.find(c => c.id === charId);
                if (!character || !character.ideaConcept) {
                    showMessage("Masukkan konsep ide untuk karakter.", "error");
                    return;
                }

                setLoading(prev => ({ ...prev, character: charId }));
                
                try {
                    // Simple mock generation using template strings
                    const concept = character.ideaConcept.toLowerCase();
                    const appearanceTemplates = [
                        `${concept} dengan mata tajam dan postur atletis`,
                        `${concept} dengan ciri khas di wajah seperti bekas luka`,
                        `${concept} dengan ekspresi datar dan tatapan kosong`
                    ];
                    
                    const clothingTemplates = [
                        `Selalu mengenakan pakaian bernuansa gelap dengan aksesori unik`,
                        `Pakaian yang sesuai dengan lingkungan alam ${concept}`,
                        `Pakaian vintage dengan sentuhan modern`
                    ];

                    const randomAppearance = appearanceTemplates[
                        Math.floor(Math.random() * appearanceTemplates.length)
                    ];
                    
                    const randomClothing = clothingTemplates[
                        Math.floor(Math.random() * clothingTemplates.length)
                    ];

                    handleDefinedCharacterChange(charId, 'appearance', randomAppearance);
                    handleDefinedCharacterChange(charId, 'clothing', randomClothing);
                    
                    showMessage("Karakter berhasil di-generate!", "success");
                } catch(error) {
                    showMessage(error.message, 'error');
                } finally {
                    setLoading(prev => ({ ...prev, character: null }));
                }
            };

            // Storyboard Generation
            const handleGenerateStoryboard = () => {
                if(!optimizedPrompt) {
                    showMessage("Hasilkan prompt optimasi terlebih dahulu.", "error");
                    return;
                }

                setLoading(prev => ({...prev, storyboard: true}));
                setStoryboard([]);

                try {
                    // Simple NLP-like processing for storyboard generation
                    const shots = [];
                    const promptWords = optimizedPrompt.split(' ');
                    
                    // Extract key elements from prompt
                    const cameraMovements = cameraMovementOptions.map(o => o.value);
                    const cameraAngles = cameraAngleOptions.map(o => o.value);
                    const lightingStyles = lightingOptions.map(o => o.value);
                    
                    // Generate mock storyboard based on keywords
                    if (cameraMovement) {
                        shots.push({
                            shot_number: 1,
                            description: `Opening Shot - ${cameraMovement}, ${cameraAngle || 'wide shot'}, menampilkan suasana ${setting || 'lingkungan umum'}`
                        });
                    }
                    
                    if (promptWords.some(word => word.includes('dialog'))) {
                        shots.push({
                            shot_number: shots.length + 1,
                            description: `Medium Shot - Fokus pada karakter utama saat berdialog, menggunakan pencahayaan ${lighting || 'alami'}`
                        });
                    }
                    
                    if (promptWords.some(word => word.includes('action'))) {
                        shots.push({
                            shot_number: shots.length + 1,
                            description: `Dynamic Shot - Menggunakan teknik ${cameraMovement || 'tracking shot'} untuk menangkap aksi intens`
                        });
                    }
                    
                    // Add default shots if none generated
                    if (shots.length === 0) {
                        shots.push(
                            {
                                shot_number: 1,
                                description: `Establishing Shot - Wide angle menampilkan lokasi utama dengan pencahayaan ${lighting || 'natural'}`
                            },
                            {
                                shot_number: 2,
                                description: `Close-up Shot - Fokus pada ekspresi karakter utama`
                            }
                        );
                    }

                    setStoryboard(shots);
                } catch(error) {
                    showMessage(error.message, 'error');
                } finally {
                    setLoading(prev => ({...prev, storyboard: false}));
                }
            };

            return (
                <div className="min-h-screen bg-slate-50 p-4 sm:p-6 lg:p-8 font-sans">
                    <div className="w-full max-w-7xl mx-auto">
                        <div className="text-center mb-10">
                            <h1 className="text-4xl md:text-5xl font-extrabold text-slate-900 mb-2">Cinematic Video Prompt Generator</h1>
                            <p className="text-lg text-slate-600">Alat pra-produksi untuk konsistensi karakter dan adegan yang memukau.</p>
                        </div>
                        
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
                            <div className="lg:col-span-2 space-y-6">
                                {/* Character Management Section */}
                                <FormSection title="Manajemen Karakter (Character Sheet)" icon={<UsersIcon />}>
                                    {definedCharacters.map((char, index) => (
                                        <div key={char.id} className="p-4 border border-slate-200 rounded-lg bg-slate-50">
                                            <div className="flex justify-between items-center mb-3">
                                                <h4 className="font-semibold text-slate-600">Karakter {index + 1}</h4>
                                                <button 
                                                    onClick={() => removeDefinedCharacter(char.id)} 
                                                    className="text-red-500 hover:text-red-700 font-bold text-xl" 
                                                    title="Hapus"
                                                >
                                                    &times;
                                                </button>
                                            </div>
                                            
                                            <div className="space-y-3">
                                                <div>
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Nama Karakter <span className="text-red-500">*</span>
                                                    </label>
                                                    <Input 
                                                        type="text" 
                                                        placeholder="Contoh: Rendra, The Wanderer" 
                                                        value={char.name} 
                                                        onChange={(e) => handleDefinedCharacterChange(char.id, 'name', e.target.value)} 
                                                    />
                                                </div>
                                                
                                                <div className="p-3 bg-blue-50 rounded-lg border border-blue-200">
                                                    <label className="block text-slate-700 text-sm font-semibold mb-2">
                                                        ✨ Asisten Karakter (AI)
                                                    </label>
                                                    <div className="flex gap-2 items-center">
                                                        <Input 
                                                            type="text" 
                                                            placeholder="Konsep ide: detektif tua..." 
                                                            value={char.ideaConcept || ''} 
                                                            onChange={(e) => handleDefinedCharacterChange(char.id, 'ideaConcept', e.target.value)} 
                                                        />
                                                        <button 
                                                            onClick={() => handleGenerateCharacter(char.id)} 
                                                            disabled={loading.character === char.id} 
                                                            className={`py-2 px-3 rounded-lg font-semibold flex items-center ${
                                                                loading.character === char.id 
                                                                    ? 'bg-slate-400' 
                                                                    : 'bg-blue-600 text-white hover:bg-blue-700'
                                                            }`}
                                                        >
                                                            {loading.character === char.id ? (
                                                                <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" viewBox="0 0 24 24">
                                                                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                                                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                                                </svg>
                                                            ) : (
                                                                <SparklesIcon />
                                                            )}
                                                        </button>
                                                    </div>
                                                </div>
                                                
                                                <div>
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Penampilan Fisik
                                                    </label>
                                                    <Textarea 
                                                        placeholder="Contoh: Pria 30 tahun, rambut hitam ikal..." 
                                                        value={char.appearance} 
                                                        onChange={(e) => handleDefinedCharacterChange(char.id, 'appearance', e.target.value)} 
                                                        rows={3}
                                                    />
                                                </div>
                                                
                                                <div>
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Gaya Pakaian Khas
                                                    </label>
                                                    <Input 
                                                        type="text" 
                                                        placeholder="Contoh: Selalu memakai kemeja flanel..." 
                                                        value={char.clothing} 
                                                        onChange={(e) => handleDefinedCharacterChange(char.id, 'clothing', e.target.value)} 
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                    
                                    <button 
                                        onClick={addDefinedCharacter} 
                                        className="w-full mt-2 py-2 px-4 bg-blue-100 text-blue-700 hover:bg-blue-200 rounded-lg font-semibold transition duration-200 flex items-center justify-center gap-2"
                                    >
                                        <PlusCircleIcon /> Tambah Karakter
                                    </button>
                                </FormSection>
                                
                                {/* Scene Composition Section */}
                                <FormSection title="Penyusunan Adegan" icon={<FilmIcon />}>
                                    <div>
                                        <label className="block text-slate-700 text-sm font-semibold mb-1">
                                            Deskripsi Inti Adegan <span className="text-red-500">*</span>
                                        </label>
                                        <Textarea 
                                            placeholder="Contoh: Sebuah pertemuan rahasia di malam hari..." 
                                            value={mainDescription} 
                                            onChange={(e) => setMainDescription(e.target.value)} 
                                            required 
                                            rows="2"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-slate-700 text-sm font-semibold mb-1">
                                            Lokasi & Atmosfer
                                        </label>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <Input 
                                                type="text" 
                                                placeholder="Contoh: gang sempit di kota hujan..." 
                                                value={setting} 
                                                onChange={(e) => setSetting(e.target.value)} 
                                            />
                                            <Select 
                                                value={visualMood} 
                                                onChange={(e) => setVisualMood(e.target.value)}
                                            >
                                                <option value="">Pilih Mood</option>
                                                {visualMoodOptions.map(o => (
                                                    <option key={o.value} value={o.value}>{o.label}</option>
                                                ))}
                                            </Select>
                                        </div>
                                    </div>
                                    
                                    {sceneSubjects.map((sub, index) => (
                                        <div key={sub.id} className="p-4 border border-slate-200 rounded-lg bg-slate-50">
                                            <div className="flex justify-between items-center mb-2">
                                                <h4 className="font-semibold text-slate-600">Aksi Subjek {index + 1}</h4>
                                                <button 
                                                    onClick={() => removeSceneSubject(sub.id)} 
                                                    className="text-red-500 hover:text-red-700 font-bold text-xl" 
                                                    title="Hapus"
                                                >
                                                    &times;
                                                </button>
                                            </div>
                                            
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Pilih Karakter
                                                    </label>
                                                    <Select 
                                                        value={sub.characterId || ''} 
                                                        onChange={(e) => handleSceneSubjectChange(sub.id, 'characterId', e.target.value ? parseInt(e.target.value, 10) : null)}
                                                    >
                                                        <option value="">Pilih Aktor</option>
                                                        {definedCharacters.map(c => (
                                                            <option key={c.id} value={c.id}>{c.name}</option>
                                                        ))}
                                                    </Select>
                                                </div>
                                                
                                                <div>
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Aksi & Emosi
                                                    </label>
                                                    <Input 
                                                        type="text" 
                                                        placeholder="Contoh: menatap dengan curiga..." 
                                                        value={sub.action} 
                                                        onChange={(e) => handleSceneSubjectChange(sub.id, 'action', e.target.value)} 
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                    
                                    <button 
                                        onClick={addSceneSubject} 
                                        className="w-full mt-2 py-2 px-4 bg-blue-100 text-blue-700 hover:bg-blue-200 rounded-lg font-semibold transition duration-200 flex items-center justify-center gap-2"
                                    >
                                        <PlusCircleIcon /> Tambah Aksi Subjek
                                    </button>
                                </FormSection>
                                
                                {/* Sound Design Section */}
                                <FormSection title="Desain Suara & Dialog" icon={<MusicIcon />}>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                Musik Latar
                                            </label>
                                            <Input 
                                                type="text" 
                                                placeholder="Contoh: alunan piano melankolis..." 
                                                value={backgroundMusic} 
                                                onChange={(e) => setBackgroundMusic(e.target.value)} 
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                Efek Suara (SFX)
                                            </label>
                                            <Input 
                                                type="text" 
                                                placeholder="Contoh: suara hujan, gema langkah..." 
                                                value={sfx} 
                                                onChange={(e) => setSfx(e.target.value)} 
                                            />
                                        </div>
                                    </div>
                                    
                                    {dialogueEntries.map((entry, index) => (
                                        <div key={entry.id} className="p-4 border border-slate-200 rounded-lg bg-slate-50 mt-4">
                                            <div className="flex justify-between items-center mb-2">
                                                <h4 className="font-semibold text-slate-600">Baris Dialog {index + 1}</h4>
                                                <button 
                                                    onClick={() => removeDialogueEntry(entry.id)} 
                                                    className="text-red-500 hover:text-red-700 font-bold text-xl" 
                                                    title="Hapus"
                                                >
                                                    &times;
                                                </button>
                                            </div>
                                            
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Karakter
                                                    </label>
                                                    <Select 
                                                        value={entry.characterId || ''} 
                                                        onChange={(e) => handleDialogueEntryChange(entry.id, 'characterId', e.target.value ? parseInt(e.target.value, 10) : null)}
                                                    >
                                                        <option value="">Pilih</option>
                                                        {definedCharacters.map(c => (
                                                            <option key={c.id} value={c.id}>{c.name}</option>
                                                        ))}
                                                    </Select>
                                                </div>
                                                
                                                <div>
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Nada Bicara
                                                    </label>
                                                    <Input 
                                                        type="text" 
                                                        placeholder="Berbisik, gembira, sarkasme..." 
                                                        value={entry.tone} 
                                                        onChange={(e) => handleDialogueEntryChange(entry.id, 'tone', e.target.value)} 
                                                    />
                                                </div>
                                                
                                                <div className="md:col-span-2">
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Isi Dialog
                                                    </label>
                                                    <Textarea 
                                                        placeholder="Contoh: 'Kita tidak punya banyak waktu.'" 
                                                        value={entry.text} 
                                                        onChange={(e) => handleDialogueEntryChange(entry.id, 'text', e.target.value)} 
                                                        rows="2"
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                    
                                    <button 
                                        onClick={addDialogueEntry} 
                                        className="w-full mt-4 py-2 px-4 bg-blue-100 text-blue-700 hover:bg-blue-200 rounded-lg font-semibold transition duration-200 flex items-center justify-center gap-2"
                                    >
                                        <PlusCircleIcon /> Tambah Dialog
                                    </button>
                                </FormSection>
                                
                                {/* Cinematography Section */}
                                <FormSection title="Sinematografi & Teknis" icon={<CameraIcon />}>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                Pergerakan Kamera
                                            </label>
                                            <Select 
                                                value={cameraMovement} 
                                                onChange={(e) => setCameraMovement(e.target.value)}
                                            >
                                                <option value="">Pilih</option>
                                                {cameraMovementOptions.map(o => (
                                                    <option key={o.value} value={o.value}>{o.label}</option>
                                                ))}
                                            </Select>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                Sudut Kamera
                                            </label>
                                            <Select 
                                                value={cameraAngle} 
                                                onChange={(e) => setCameraAngle(e.target.value)}
                                            >
                                                <option value="">Pilih</option>
                                                {cameraAngleOptions.map(o => (
                                                    <option key={o.value} value={o.value}>{o.label}</option>
                                                ))}
                                            </Select>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                Pencahayaan
                                            </label>
                                            <Select 
                                                value={lighting} 
                                                onChange={(e) => setLighting(e.target.value)}
                                            >
                                                <option value="">Pilih</option>
                                                {lightingOptions.map(o => (
                                                    <option key={o.value} value={o.value}>{o.label}</option>
                                                ))}
                                            </Select>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                Gaya Visual
                                            </label>
                                            <Select 
                                                value={cinematicStyle} 
                                                onChange={(e) => setCinematicStyle(e.target.value)}
                                            >
                                                <option value="">Pilih</option>
                                                {cinematicStyleOptions.map(o => (
                                                    <option key={o.value} value={o.value}>{o.label}</option>
                                                ))}
                                            </Select>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                Rasio Aspek
                                            </label>
                                            <Select 
                                                value={aspectRatio} 
                                                onChange={(e) => setAspectRatio(e.target.value)}
                                            >
                                                {aspectRatioOptions.map(o => (
                                                    <option key={o.value} value={o.value}>{o.label}</option>
                                                ))}
                                            </Select>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                Kualitas Video
                                            </label>
                                            <Select 
                                                value={videoQuality} 
                                                onChange={(e) => setVideoQuality(e.target.value)}
                                            >
                                                <option value="">Pilih Kualitas</option>
                                                {videoQualityOptions.map(o => (
                                                    <option key={o} value={o}>{o}</option>
                                                ))}
                                            </Select>
                                        </div>
                                    </div>
                                </FormSection>
                            </div>
                            
                            {/* Results Section */}
                            <div className="lg:col-span-1 lg:sticky top-8 self-start">
                                <div className="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                                    <h2 className="text-xl font-bold mb-4 text-slate-800">Hasil & Aksi</h2>
                                    <button 
                                        onClick={generatePrompt} 
                                        className={`w-full py-3 px-6 rounded-lg font-bold text-white transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center text-lg ${
                                            loading.main || !mainDescription 
                                                ? 'bg-slate-400 cursor-not-allowed' 
                                                : 'bg-blue-600 hover:bg-blue-700 shadow-lg'
                                        }`} 
                                        disabled={loading.main || !mainDescription}
                                    >
                                        {loading.main ? (
                                            <><svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" viewBox="0 0 24 24">
                                                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                            </svg> Menghasilkan...</>
                                        ) : 'Hasilkan Prompt Video'}
                                    </button>
                                    
                                    {(!loading.main && (indonesianPrompt || englishPrompt || optimizedPrompt)) && (
                                        <div className="mt-6 space-y-4 animate-fade-in">
                                            {indonesianPrompt && (
                                                <div className="relative">
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Prompt Indonesia
                                                    </label>
                                                    <Textarea 
                                                        readOnly 
                                                        value={indonesianPrompt} 
                                                        rows="5" 
                                                        className="bg-slate-100" 
                                                    />
                                                    <button 
                                                        onClick={() => copyToClipboard(indonesianPrompt, 'Prompt Indonesia')} 
                                                        className="absolute top-8 right-2 text-slate-400 hover:text-blue-600 p-1" 
                                                        title="Salin"
                                                    >
                                                        <CopyIcon />
                                                    </button>
                                                </div>
                                            )}
                                            
                                            {englishPrompt && (
                                                <div className="relative">
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Prompt Inggris
                                                    </label>
                                                    <Textarea 
                                                        readOnly 
                                                        value={englishPrompt} 
                                                        rows="5" 
                                                        className="bg-slate-100" 
                                                    />
                                                    <button 
                                                        onClick={() => copyToClipboard(englishPrompt, 'Prompt Inggris')} 
                                                        className="absolute top-8 right-2 text-slate-400 hover:text-blue-600 p-1" 
                                                        title="Salin"
                                                    >
                                                        <CopyIcon />
                                                    </button>
                                                </div>
                                            )}
                                            
                                            {optimizedPrompt && (
                                                <div className="relative">
                                                    <label className="block text-slate-700 text-sm font-semibold mb-1">
                                                        Prompt Optimasi (Director's Cut)
                                                    </label>
                                                    <Textarea 
                                                        readOnly 
                                                        value={optimizedPrompt} 
                                                        rows="7" 
                                                        className="bg-slate-100" 
                                                    />
                                                    <button 
                                                        onClick={() => copyToClipboard(optimizedPrompt, 'Prompt Optimasi')} 
                                                        className="absolute top-8 right-2 text-slate-400 hover:text-blue-600 p-1" 
                                                        title="Salin"
                                                    >
                                                        <CopyIcon />
                                                    </button>
                                                </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                                
                                {optimizedPrompt && (
                                    <div className="bg-white p-6 rounded-lg shadow-sm border border-slate-200 mt-6">
                                        <h2 className="text-xl font-bold mb-4 flex items-center gap-3 text-slate-800">
                                            <ClipboardListIcon />Asisten Sutradara
                                        </h2>
                                        <button 
                                            onClick={handleGenerateStoryboard} 
                                            className={`w-full py-2 px-4 rounded-lg font-semibold text-white transition-all duration-300 flex items-center justify-center ${
                                                loading.storyboard 
                                                    ? 'bg-slate-400 cursor-not-allowed' 
                                                    : 'bg-blue-600 hover:bg-blue-700'
                                            }`} 
                                            disabled={loading.storyboard}
                                        >
                                            {loading.storyboard ? (
                                                <><svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" viewBox="0 0 24 24">
                                                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                                </svg> Membuat Storyboard...</>
                                            ) : '✨ Buat Storyboard Adegan'}
                                        </button>
                                        
                                        {storyboard.length > 0 && (
                                            <div className="mt-4 space-y-3 animate-fade-in">
                                                {storyboard.map(shot => (
                                                    <div key={shot.shot_number} className="p-3 bg-slate-100 rounded-lg text-sm">
                                                        <p>
                                                            <strong className="font-semibold text-slate-700">
                                                                Shot {shot.shot_number}:
                                                            </strong> {shot.description}
                                                        </p>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>
                        
                        <footer className="text-center mt-12 py-4">
                            <p className="text-sm text-slate-500">raf_dev</p>
                        </footer>
                    </div>
                    
                    <MessageBox message={message} type={messageType} onClose={() => setMessage('')} />
                </div>
            );
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
